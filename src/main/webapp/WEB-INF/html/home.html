<!DOCTYPE html>
<html lang='en'>
<head>

<link href="../static/css/bootstrap.css" rel="stylesheet">
<link href="../static/css/main.css" rel="stylesheet">
</head>
<body>

<div id='container' class='container navbar navbar-default'>
	<!--<a href='index.html' class='navbar-brand'>ForumApp</a>-->

	<!--<ul class='nav navbar-nav navbar-right'>
		<li><a class='nav navbar navbar-brand navbar-right' href='index.html'>Home</a></li>
		<li><a class='nav navbar navbar-brand navbar-right' href='profile.html'>My Profile</a></li>
		<li><a class='nav navbar navbar-brand navbar-right' href='settings.html'>Settings</a></li>
	</ul>-->

	<div class='row'>
		<a href='home.html' class='nav navbar-brand'>ForumApp</a>
		<ul class='list-unstyled list-inline nav navbar-nav navbar-right'>
			<li><a class='nav navbar-nav navbar-brand' href='home.html'>Home</a></li>
			<li><a class='nav navbar-nav navbar-brand' href='mytopics.html'>My Topics</a></li>
		</ul>
	</div>
	
	<div class='row well well-lg'>
		<div id="topicList">
   			
		</div>
	</div>
	
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="../static/js/bootstrap.js"></script>

<script type="text/javascript">
	
	$(document).ready(function() {
		
		getAllTopics();
		
	});

	//to get all topics on home page
	function getAllTopics() {
		//alert("inside getAllTopics");
		var topicsUrl = "http://localhost:8080/forum-api/topic/getAllTopics";
		
		var jsonData={ 	"status" : "success",
						"topicList" : [
						               {
						            	   	"id":"1",
											"title":"pune marathon last month",
											"description":"sample topic",
											"createdAt":"2017-07-23 16:11:10",
											"createdBy":"Swapnil Solanki",
											"voteCount":"10",
											"tags":"sports",
											"topicUrl":"testTopic1",
											"commentList" :[
															{
																"id":"1",
																"type":"T",
																"value":"awesome marathon",
																"createdAt":"2017-07-24 16:11:10",
																"createdBy":"punjabi",
																"topicId":"1"
															},
															{
																"id":"3",
																"type":"T",
																"value":"loved it!",
																"createdAt":"2017-07-25 12:11:10",
																"createdBy":"Ankit",
																"topicId":"1"
															}
															]
										},
										{
						            	   	"id":"2",
											"title":"TEDx event in bangalore",
											"description":"sample topic2",
											"createdAt":"2017-07-21 16:11:10",
											"createdBy":"Himanshu Singh",
											"voteCount":"20",
											"tags":"music",
											"topicUrl":"testTopic2",
											"commentList" :[
															{
																"id":"2",
																"type":"T",
																"value":"it as nice one!",
																"createdAt":"2017-07-22 16:11:10",
																"createdBy":"balaji",
																"topicId":"2"
																}
															]
										}
						               ]
						};
					
		
		if(jsonData.status=="success") {
			//alert("jsonData length: "+jsonData.length);
			var data = jsonData.topicList;
			
			//$.getJSON( jsonData , function( data ) {
			for (var i = 0; i < data.length; i++) {
				var id;
				var title;
				var description;
				var createdAt;
				var createdBy;
				var voteCount;
				var tags;
				var topicUrl;
				var commentList;
				
				var j = 0;
				var topics = [];
				topics.push("<div id='topic' class='row well well-lg'>");
				$.each( data[i] , function( key, val ) {
					if(key.toString()=="id"){
						id=val;
					} else if(key.toString()=="title"){
						title=val;
					} else if(key.toString()=="description"){
						description=val;
					} else if(key.toString()=="createdAt"){
						createdAt=val;
					} else if(key.toString()=="createdBy"){
						createdBy=val;
					} else if(key.toString()=="voteCount"){
						voteCount=val;
					} else if(key.toString()=="tags"){
						tags=val;
					} else if(key.toString()=="topicUrl"){
						topicUrl=val;
					} else if(key.toString()=="commentList"){
						commentList=val;
					}
					//topics.push( "<li id='" + key + "'>" + val + "</li>" );
					j++;
				});
				
				topics.push( "<label class='row well strong lead col-md-12 large text-primary' id='title'>" + title + "</label>" );
				/* topics.push( "</br><label id='description'>" + description + "</label>" ); */
				topics.push( "</br><label class='small' id='voteCount'>"+ voteCount + " Votes </label>" );
				topics.push( "&nbsp&nbsp&nbsp&nbsp<label class='small text-info' id='createdBy'> Created By: "+ createdBy + "</label>" );
				topics.push( "&nbsp&nbsp&nbsp&nbsp<label class='small' id='createdAt'> Created At: "+ createdAt + "</label>" );
				
				topics.push( "<div id='commentList'>" );   //start commentList logic
				for (var l = 0; l < commentList.length; l++) {
					var commentId;
					var commentType;
					var commentValue;
					var commentCreatedAt;
					var commentCreatedBy;
					var topicId;
					var comments = [];
					var k=0;
					//alert("comments length: "+commentList.length);
					$.each( commentList[l] , function( key, val ) {
						//alert("key: "+key +" ,value: "+val);
						if(key.toString()=="id"){
							commentId=val;
						} else if(key.toString()=="type"){
							commentType=val;
						} else if(key.toString()=="value"){
							commentValue=val;
						} else if(key.toString()=="createdAt"){
							commentCreatedAt=val;
						} else if(key.toString()=="createdBy"){
							commentCreatedBy=val;
						} else if(key.toString()=="topicId"){
							topicId=val;
						}
						//comments.push( "<label class='row well small' id='commentCreatedBy'>" + commentCreatedBy + "</label>");	
						//comments.push( "&nbsp&nbsp&nbsp<label class='small' id='commentValue'>" + commentValue + "</label>");
						
						//$(comments.join( "" )).appendTo( "#commentList" );
						k++;
					});
					
					comments.push( "<div class='row'>");
						comments.push( "<label class='col-md-offset-1 col-md-2 small ' id='commentCreatedBy'>" + commentCreatedBy + "</label>");
						comments.push( "&nbsp&nbsp&nbsp&nbsp<label class='small col-md-8' id='commentValue'>"+ commentValue + "</label>" );
					comments.push( "</div>");
					
					comments.push("</div>");   //end commentList logic
					$(comments.join( "" )).appendTo( "#commentList" );
				}
				
				topics.push("</div>");
				
				/* $( "<ul/>", {
				//$( "", {
					html: topics.join( "" )
				}).appendTo( "#topicList" ); */
				//$( "<ul/>", {
				$(topics.join( "" )).appendTo( "#topicList" );
			}
			//});
			
		}
		
		/* $.ajax({
			type: "GET",
			url: topicsUrl,
			dataType: "json",
			success: function(data) {
				//alert(data);
				if(data.status == "success"){
					
				}else{
				    alert("Some error in loading, please try again!");
				}
			}
		}); */
	}
</script>

</body>
</html>